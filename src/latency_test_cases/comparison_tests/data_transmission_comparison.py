# Record test results for data transmission between KyberKEM, 1 byte and RSA-KEM
import matplotlib.pyplot as plt
import numpy as np

# -- FOR SINGLE HOP (2 nodes) --

# PK
rsa_results_pk = [0.20377488200028893, 
                  0.20317419999992126, 
                  0.2030841870000586, 
                  0.20333181400201283, 
                  0.2040512760031561,
                  0.2035554050016799,
                  0.2031455989999813,
                  0.2033969399999478,
                  0.2039033399996697,
                  0.20392030500079272]

pqc_results_pk = [0.20291117699889583,
                  0.20377168300183257, 
                  0.20396319599967683, 
                  0.20412228200075333, 
                  0.20348616100091022,
                  0.2034115649985324,
                  0.2028802829991036,
                  0.20271867799965548,
                  0.20268752299671178,
                  0.20316821099913795]   

one_byte_results_pk = [0.20311278100052732,
                       0.20362296599705587,
                       0.20350452300044708,
                       0.2025743779995537,
                       0.20399273699877085,
                       0.20364728799904697,
                       0.20341789399753907,
                       0.20358518200009712,
                       0.203402728002402,
                       0.20373766899865586]

# CT
rsa_results_ct = [0.20377506699878722, 
                  0.20342183200045838, 
                  0.20354137200047262, 
                  0.20360822399743483, 
                  0.20319163100066362,
                  0.20323911299783504,
                  0.20261129999926197,
                  0.20247575400208007,
                  0.20344671299972106,
                  0.20340078599838307]

pqc_results_ct = [0.20267803500246373, 
                  0.20381622000058996, 
                  0.20312388999809627, 
                  0.20368151200091233, 
                  0.20366782300334307,
                  0.20359724900117726,
                  0.2030747990029340,
                  0.2022264469997026,
                  0.20290045900037512,
                  0.2028449190001993,]  
 
one_byte_results_ct = [0.2035170349990949,
                       0.20436439200057066,
                       0.20363321300101234,
                       0.20274645300014527,
                       0.20353872499981662,
                       0.20346348299790407,
                       0.20381688099951134,
                       0.20320386400271673,
                       0.20350660199983395,
                       0.20322207999925013]

# Calculate the Stats for PK
means_pk_1hop = [np.mean(rsa_results_pk), np.mean(pqc_results_pk), np.mean(one_byte_results_pk)]
stds_pk_1hop = [np.std(rsa_results_pk), np.std(pqc_results_pk), np.std(one_byte_results_pk)]

# Calculate the Stats for Ct
means_ct_1hop = [np.mean(rsa_results_ct), np.mean(pqc_results_ct), np.mean(one_byte_results_ct)]
stds_ct_1hop = [np.std(rsa_results_ct), np.std(pqc_results_ct), np.std(one_byte_results_ct)]


print("-- MEAN for pk 1 hop --")
print("rsa", means_pk_1hop[0])
print("pqc", means_pk_1hop[1])
print("one byte", means_pk_1hop[2])

print("-- MEAN for ct 1 hop --")
print("rsa", means_ct_1hop[0])
print("pqc", means_ct_1hop[1])
print("one byte", means_ct_1hop[2])

# -- FOR 2 HOPS (3 nodes) --
rsa_results_pk_2 = [0.406014561001939,
                    0.40598173100079293,
                    0.4040245659998618,
                    0.40551576699726866,
                    0.40371338900149567,
                    0.40522396599772037,
                    0.40497198600132833,
                    0.40559968200250296,
                    0.40493247599806637,
                    0.40387385199937853]

pqc_results_pk_2 = [0.40512619400033145,
                    0.40577028899861034,
                    0.4053772189981828,
                    0.40667072200085386,
                    0.40370487100153696,
                    0.405026024000108,
                    0.40418358399983845,
                    0.40624122799999896,
                    0.40622255799826235,
                    0.4041846460022498]   

one_byte_results_pk_2 = [0.40499810999972397,
                         0.4054738919985539,
                         0.40501453400065657,
                         0.4051889289985411,
                         0.40514718900158186,
                         0.4045354990012129,
                         0.40454403100011405,
                         0.4042936420009937,
                         0.4052488289999019,
                         0.4047875189971819]

# CT
rsa_results_ct_2 = [0.40574949700021534,
                    0.4051787379976304,
                    0.4035658790016896,
                    0.40604679099851637,
                    0.40366089999952237,
                    0.40526162999958615,
                    0.4044657170015853,
                    0.40472071299882373,
                    0.40466783899682923,
                    0.4042627899980289]

pqc_results_ct_2 = [0.40524711800026125,
                    0.40546412900221185,
                     0.4047919689983246,
                     0.40515634400071576,
                     0.40441132100022514,
                     0.40501775599841494,
                     0.4046833049978886,
                     0.4059760809977888,
                     0.40539700700173853,
                    0.40403136299937614]  
 
one_byte_results_ct_2 = [0.40522116600186564,
                         0.40502426699822536,
                         0.40507099900059984,
                         0.4058140760025708,
                         0.40587309900001856,
                         0.4045494809979573,
                         0.40454403100011405,
                         0.40397731800112524,
                         0.4040871879988117,
                         0.4049169419995451]

# Calculate the Stats for PK
means_pk_2hop = [np.mean(rsa_results_pk_2), np.mean(pqc_results_pk_2), np.mean(one_byte_results_pk_2)]
stds_pk_2hop = [np.std(rsa_results_pk_2), np.std(pqc_results_pk_2), np.std(one_byte_results_pk_2)]

# Calculate the Stats for Ct
means_ct_2hop = [np.mean(rsa_results_ct_2), np.mean(pqc_results_ct_2), np.mean(one_byte_results_ct_2)]
stds_ct_2hop = [np.std(rsa_results_ct_2), np.std(pqc_results_ct_2), np.std(one_byte_results_ct_2)]


print("-- MEAN for pk 2 hop --")
print("rsa", means_pk_2hop[0])
print("pqc", means_pk_2hop[1])
print("one byte", means_pk_2hop[2])

print("-- MEAN for ct 2 hop --")
print("rsa", means_ct_2hop[0])
print("pqc", means_ct_2hop[1])
print("one byte", means_ct_2hop[2])

# -- FOR 4 HOPS (5 nodes) --
rsa_results_pk_4 = [ 0.8082666549998976,
                    0.8077893429981486,
                    0.810077406000346,
                    0.8069092850018933,
                    0.8105177729994466,
                     0.8109893000000739,
                     0.8099108569986129,
                     0.8099080940010026,
                     0.8100295259973791,
                     0.8094812310009729]

pqc_results_pk_4 = [0.8107001639982627,
                    0.8106941519981774,
                    0.8073026989986829,
                    0.8114936420024605,
                    0.8101906530027918,
                    0.8079405710013816,
                    0.8108348329988075,
                    0.8102930399982142,
                    0.8112398680023034,
                    0.8105315640023036]   

one_byte_results_pk_4 = [0.8103438450016256,
                         0.8108765819997643,
                         0.8107227949985827,
                         0.8091518500004895,
                          0.8095769870014919,
                          0.81016318699767,
                          0.8097117639990756,
                          0.8081555800017668,
                          0.810212574997422,
                          0.8096827299996221]

# CT
rsa_results_ct_4 = [0.8083894439987489,
                    0.8079538530000718,
                    0.809473421999428,
                    0.8070960370023386,
                     0.809489585000847,
                     0.8098768329982704,
                     0.8094798189995345,
                     0.809445353999763,
                     0.810105530999862,
                     0.8088578030001372]

pqc_results_ct_4 = [0.8107086349991732,
                    0.8102169439989666,
                    0.8072154760011472,
                    0.8107932950006216,
                    0.8099910370001453,
                    0.8077566939973622,
                    0.8109231679991353,
                    0.8092068539990578,
                    0.8104295999983151,
                    0.8101713450014358]  
 
one_byte_results_ct_4 = [0.8093996919997153,
                         0.8110114119990612,
                         0.8111423090012977,
                          0.8098646459984593,
                           0.809043876000942,
                           0.8107634670013795,
                           0.8100466830001096,
                           0.8083048150001559,
                           0.8097636370002874,
                            0.8097733809991041]

# Calculate the Stats for PK
means_pk_4hop = [np.mean(rsa_results_pk_4), np.mean(pqc_results_pk_4), np.mean(one_byte_results_pk_4)]
stds_pk_4hop = [np.std(rsa_results_pk_4), np.std(pqc_results_pk_4), np.std(one_byte_results_pk_4)]

# Calculate the Stats for Ct
means_ct_4hop = [np.mean(rsa_results_ct_4), np.mean(pqc_results_ct_4), np.mean(one_byte_results_ct_4)]
stds_ct_4hop = [np.std(rsa_results_ct_4), np.std(pqc_results_ct_4), np.std(one_byte_results_ct_4)]


print("-- MEAN for pk 4 hop --")
print("rsa", means_pk_4hop[0])
print("pqc", means_pk_4hop[1])
print("one byte", means_pk_4hop[2])

print("-- MEAN for ct 4 hop --")
print("rsa", means_ct_4hop[0])
print("pqc", means_ct_4hop[1])
print("one byte", means_ct_4hop[2])